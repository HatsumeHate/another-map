---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Stasik.
--- DateTime: 11.02.2020 16:14
---
do

    TeleportFrame = {}
    TeleportLocation = {}
    local PlayerCurrentButtonList = {}


    local function TeleportButtonPressed()
        local frame = BlzGetTriggerFrame()
        local player = GetPlayerId(GetTriggerPlayer()) + 1


            PlayLocalSound("location_change.wav", player - 1, 110)
            BlzFrameSetVisible(TeleportFrame[player].mainframe, false)

            for i = 1, #TeleportLocation[i] do
                if PlayerCurrentButtonList[player].buttonlist[i].button == frame then
                    SetUnitX(PlayerHero[player], GetRectCenterX(PlayerCurrentButtonList[player].buttonlist[i].teleport))
                    SetUnitY(PlayerHero[player], GetRectCenterY(PlayerCurrentButtonList[player].buttonlist[i].teleport))
                    break
                end
            end

    end




    for i = 1, 7 do
        PlayerCurrentButtonList[i] = {}
    end

    function ShowTeleportList(trackable, player)
        BlzFrameSetVisible(TeleportFrame[player].mainframe, true)
        local slot = 1

            for i = 1, #TeleportLocation do
                --if TeleportLocation[i].trackable ~= trackable then
                    BlzFrameClearAllPoints(TeleportFrame[player].slots[slot].button)
                    BlzFrameSetVisible(TeleportFrame[player].slots[slot].button, true)
                    BlzFrameSetText(TeleportFrame[player].slots[slot].text, TeleportLocation[i].name)

                        if slot == 1 then
                            BlzFrameSetPoint(TeleportFrame[player].slots[slot].button, FRAMEPOINT_TOP, TeleportFrame[i].mainframe, FRAMEPOINT_TOP, 0., -0.04)
                        else
                            BlzFrameSetPoint(TeleportFrame[player].slots[slot].button, FRAMEPOINT_TOP, TeleportFrame[player].slots[slot-1].button, FRAMEPOINT_BOTTOM, 0., -0.001)
                        end

                PlayerCurrentButtonList[player].buttonlist[i].button = TeleportFrame[player].slots[slot].button
                PlayerCurrentButtonList[player].buttonlist[i].teleport = TeleportLocation[i].rect
                slot = slot + 1
                --end
            end


        BlzFrameSetSize(TeleportFrame[player].mainframe, BlzFrameGetWidth(TeleportFrame[player].mainframe), (BlzFrameGetHeight(TeleportFrame[player].slots[slot].button) + (0.001 * slot)) * slot + 0.04)

    end


    RegisterTestCommand("show", function() ShowTeleportList(nil, 1) end)
    RegisterTestCommand("tp", function() CreateTeleportFrame() end)


    function CreateTeleportFrame()

        local trg = CreateTrigger()
        TriggerAddAction(trg, TeleportButtonPressed)

        for i = 1, 7 do
            TeleportFrame[i] = {}
            TeleportFrame[i].mainframe =  BlzCreateFrame('EscMenuBackdrop', GAME_UI, 0, 0)

            BlzFrameSetPoint(TeleportFrame[i].mainframe, FRAMEPOINT_CENTER, GAME_UI, FRAMEPOINT_CENTER, 0., 0.)
            BlzFrameSetSize(TeleportFrame[i].mainframe, 0.12, 0.2)

            TeleportFrame[i].slots = {}

                for k = 1, 6 do
                    TeleportFrame[i].slots[k] = {}
                    TeleportFrame[i].slots[k].button = BlzCreateFrame('ScriptDialogButton', TeleportFrame[i].mainframe, 0, 0)
                    TeleportFrame[i].slots[k].text = BlzGetFrameByName("ScriptDialogButtonText", 0)
                    BlzFrameSetSize(TeleportFrame[i].slots[k].button, BlzFrameGetWidth(TeleportFrame[i].mainframe) * 0.8, 0.025)
                    BlzFrameSetTextAlignment(TeleportFrame[i].slots[k].text, TEXT_JUSTIFY_CENTER , TEXT_JUSTIFY_MIDDLE)
                    BlzFrameSetVisible(TeleportFrame[i].slots[k].button, false)
                    BlzTriggerRegisterFrameEvent(trg, TeleportFrame[i].slots[k].button, FRAMEEVENT_CONTROL_CLICK)

                end

            BlzFrameSetVisible(TeleportFrame[i].mainframe, false)
        end

    end


    function TeleporterInit()

        TeleportLocation[1] = { name = LOCALE_LIST[my_locale].CASTLE_LOCATION, rect = gg_rct_castle_loc, trackable = nil }
        TeleportLocation[2] = { name = LOCALE_LIST[my_locale].SHORE_LOCATION, rect = gg_rct_shore_loc, trackable = nil }
        TeleportLocation[3] = { name = LOCALE_LIST[my_locale].WOODS_LOCATION, rect = gg_rct_woods_loc, trackable = nil }

        for i = 1, 7 do
            PlayerCurrentButtonList[i] = {}
            PlayerCurrentButtonList[i].buttonlist = {}
            for k = 1, 10 do
                PlayerCurrentButtonList[i].buttonlist[k] = {}
            end
        end

    end


end