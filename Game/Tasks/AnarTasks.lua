---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by MSI.
--- DateTime: 02.04.2022 16:37
---
do

    PlayerTask = nil


    function Task_Arachno_Done(player)
        local lootbox = CreateCustomItem("I02H", GetUnitX(PlayerHero[player]), GetUnitY(PlayerHero[player]), false, player-1)
        local unit_data = GetUnitData(gg_unit_n029_0022)

        if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker_done, ANIM_TYPE_DEATH) end

            AddToInventory(player, lootbox)
            GiveGoldForPlayer(1000, player)
            GiveExpForPlayer(450, player)
            RemoveJournalEntry(player, "task_arachno")
            LockInteractiveOptionId(gg_unit_n029_0022, "anar_task_arachno_done")
            PlayerTask[player] = false

    end

    function Task_Arachno_Aquired(player)
        local unit_data = GetUnitData(gg_unit_n029_0022)
        local trigger = CreateTrigger()

        if GetLocalPlayer() == Player(player - 1) then
            BlzPlaySpecialEffect(unit_data.daily_questmarker, ANIM_TYPE_DEATH)
        end

        LockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_arachno", player)
        AddJournalEntry(player, "task_arachno", "ReplaceableTextures\\CommandButtons\\BTNArachnathidpurple.blp", GetLocalString("Поручение: Арахнид Повелитель", "Task: The Arachno Overlord"), 150, true)
        AddJournalEntryObjective(player, "task_arachno", "arachno_killed", GetLocalString("Арахнид убит","Arachno is killed"))
        AddJournalEntryText(player, "task_arachno", GetConversationText("quartermaster_task_arachno_give", gg_unit_n029_0022, player))

        TriggerRegisterPlayerUnitEvent(trigger, SECOND_MONSTER_PLAYER, EVENT_PLAYER_UNIT_DEATH, nil)
        TriggerAddAction(trigger, function()
            if GetTriggerUnit() == BossPack[1].boss and IsUnitInRange(PlayerHero[player], GetTriggerUnit(), 1400.) then
                DestroyTrigger(trigger)
                UnlockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_arachno_done", player)
                SetJournalEntryObjectiveState(player, "task_arachno","arachno_killed", JOURNAL_OBJECTIVE_STATE_DONE, true)
                if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker_done, ANIM_TYPE_STAND) end
            end
        end)
    end


    function EnableTask_Arachno(player)
        local unit_data = GetUnitData(gg_unit_n029_0022)

        if GetLocalPlayer() == Player(player - 1) then
            BlzPlaySpecialEffect(unit_data.daily_questmarker, ANIM_TYPE_STAND)
        end

        UnlockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_arachno", player)
    end




    function Task_BanditLord_Done(player)
        local lootbox = CreateCustomItem("I02H", GetUnitX(PlayerHero[player]), GetUnitY(PlayerHero[player]), false, player-1)
        local unit_data = GetUnitData(gg_unit_n029_0022)

        if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker_done, ANIM_TYPE_DEATH) end

            AddToInventory(player, lootbox)
            GiveGoldForPlayer(1000, player)
            GiveExpForPlayer(450, player)
            RemoveJournalEntry(player, "task_banditlord")
            LockInteractiveOptionId(gg_unit_n029_0022, "anar_task_banditlord_done")
            PlayerTask[player] = false

    end

    function Task_BanditLord_Aquired(player)
        local unit_data = GetUnitData(gg_unit_n029_0022)
        local trigger = CreateTrigger()

        if GetLocalPlayer() == Player(player - 1) then
            BlzPlaySpecialEffect(unit_data.daily_questmarker, ANIM_TYPE_DEATH)
        end

        LockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_banditlord", player)
        AddJournalEntry(player, "task_banditlord", "ReplaceableTextures\\CommandButtons\\BTNBanditLord.blp", GetLocalString("Поручение: Главарь Бандитов", "Task: The Bandit Lord"), 150, true)
        AddJournalEntryObjective(player, "task_banditlord", "banditlord_killed", GetLocalString("Главарь бандитов убит","Bandit Lord is killed"))
        AddJournalEntryText(player, "task_banditlord", GetConversationText("quartermaster_task_banditlord_give", gg_unit_n029_0022, player))

        TriggerRegisterPlayerUnitEvent(trigger, SECOND_MONSTER_PLAYER, EVENT_PLAYER_UNIT_DEATH, nil)
        TriggerAddAction(trigger, function()
            if GetTriggerUnit() == BossPack[2].boss and IsUnitInRange(PlayerHero[player], GetTriggerUnit(), 1400.) then
                DestroyTrigger(trigger)
                UnlockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_banditlord_done", player)
                SetJournalEntryObjectiveState(player, "task_banditlord","banditlord_killed", JOURNAL_OBJECTIVE_STATE_DONE, true)
                if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker_done, ANIM_TYPE_STAND) end
            end
        end)
    end


    function EnableTask_BanditLord(player)
        local unit_data = GetUnitData(gg_unit_n029_0022)

        if GetLocalPlayer() == Player(player - 1) then
            BlzPlaySpecialEffect(unit_data.daily_questmarker, ANIM_TYPE_STAND)
        end

        UnlockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_banditlord", player)
    end



    function Task_RestlessUndead_Done(player)
        local lootbox = CreateCustomItem("I02H", GetUnitX(PlayerHero[player]), GetUnitY(PlayerHero[player]), false, player-1)
        local unit_data = GetUnitData(gg_unit_n029_0022)

        if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker_done, ANIM_TYPE_DEATH) end

            AddToInventory(player, lootbox)
            GiveGoldForPlayer(1000, player)
            GiveExpForPlayer(450, player)
            RemoveJournalEntry(player, "task_restlessundead")
            LockInteractiveOptionId(gg_unit_n029_0022, "anar_task_restlessundead_done")
            PlayerTask[player] = false

    end

    function Task_RestlessUndead_Aquired(player)
        local unit_data = GetUnitData(gg_unit_n029_0022)
        local trigger = CreateTrigger()

        if GetLocalPlayer() == Player(player - 1) then
            BlzPlaySpecialEffect(unit_data.daily_questmarker, ANIM_TYPE_DEATH)
        end

        LockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_restlessundead", player)
        AddJournalEntry(player, "task_restlessundead", "UI\\BTND1KingLeoric.blp", GetLocalString("Поручение: Неупокоенный Мертвец", "Task: The Restless Undead"), 150, true)
        AddJournalEntryObjective(player, "task_restlessundead", "restlessundead_killed", GetLocalString("Мертвый Король убит", "Undead King is killed"))
        AddJournalEntryText(player, "task_restlessundead", GetConversationText("quartermaster_task_restlessundead_give", gg_unit_n029_0022, player))

        TriggerRegisterPlayerUnitEvent(trigger, SECOND_MONSTER_PLAYER, EVENT_PLAYER_UNIT_DEATH, nil)
        TriggerAddAction(trigger, function()
            if GetTriggerUnit() == BossPack[4].boss and IsUnitInRange(PlayerHero[player], GetTriggerUnit(), 1400.) then
                DestroyTrigger(trigger)
                UnlockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_restlessundead_done", player)
                SetJournalEntryObjectiveState(player, "task_restlessundead","restlessundead_killed", JOURNAL_OBJECTIVE_STATE_DONE, true)
                if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker_done, ANIM_TYPE_STAND) end
            end
        end)
    end


    function EnableTask_RestlessUndead(player)
        local unit_data = GetUnitData(gg_unit_n029_0022)

        if GetLocalPlayer() == Player(player - 1) then
            BlzPlaySpecialEffect(unit_data.daily_questmarker, ANIM_TYPE_STAND)
        end

        UnlockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_restlessundead", player)
    end




    function Task_SpiderQueen_Done(player)
        local lootbox = CreateCustomItem("I02H", GetUnitX(PlayerHero[player]), GetUnitY(PlayerHero[player]), false, player-1)
        local unit_data = GetUnitData(gg_unit_n029_0022)

        if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker_done, ANIM_TYPE_DEATH) end

            AddToInventory(player, lootbox)
            GiveGoldForPlayer(1000, player)
            GiveExpForPlayer(450, player)
            RemoveJournalEntry(player, "task_spiderqueen")
            LockInteractiveOptionId(gg_unit_n029_0022, "anar_task_spiderqueen_done")
            PlayerTask[player] = false

    end

    function Task_SpiderQueen_Aquired(player)
        local unit_data = GetUnitData(gg_unit_n029_0022)
        local trigger = CreateTrigger()

        if GetLocalPlayer() == Player(player - 1) then
            BlzPlaySpecialEffect(unit_data.daily_questmarker, ANIM_TYPE_DEATH)
        end

        LockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_spiderqueen", player)
        AddJournalEntry(player, "task_spiderqueen", "ReplaceableTextures\\CommandButtons\\BTNSpiderBlue.blp", GetLocalString("Поручение: Королева Пауков", "Task: The Brood Mother"), 150, true)
        AddJournalEntryObjective(player, "task_spiderqueen", "spiderqueen_killed", GetLocalString("Королева Пауков убита","Spider Queen is killed"))
        AddJournalEntryText(player, "task_spiderqueen", GetConversationText("quartermaster_task_spiderqueen_give", gg_unit_n029_0022, player))

        TriggerRegisterPlayerUnitEvent(trigger, SECOND_MONSTER_PLAYER, EVENT_PLAYER_UNIT_DEATH, nil)
        TriggerAddAction(trigger, function()
            if GetTriggerUnit() == BossPack[3].boss and IsUnitInRange(PlayerHero[player], GetTriggerUnit(), 1400.) then
                DestroyTrigger(trigger)
                UnlockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_spiderqueen_done", player)
                SetJournalEntryObjectiveState(player, "task_spiderqueen","spiderqueen_killed", JOURNAL_OBJECTIVE_STATE_DONE, true)
                if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker_done, ANIM_TYPE_STAND) end
            end
        end)
    end


    function EnableTask_SpiderQueen(player)
        local unit_data = GetUnitData(gg_unit_n029_0022)
        if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker, ANIM_TYPE_STAND) end
        UnlockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_spiderqueen", player)
    end



    --===========================================================--

    SoldierRescueTaskData = nil


    function UnitShout(unit, content, duration)
        local texttag = CreateTextTag()

            SetTextTagText(texttag, content, CONSTANT_TEXT_SIZE)
            SetTextTagPos(texttag, GetUnitX(unit), GetUnitY(unit), 45. + GetUnitFlyHeight(unit))
            SetTextTagColor(texttag, 255, 255, 255, 255)

            DelayAction(duration, function()
                DestroyTextTag(texttag)
            end)
    end


    local function MonsterSpawner(unit, x, y)
        local sfx = AddSpecialEffect("Effect\\Void Teleport Red To.mdx", GetUnitX(unit), GetUnitY(unit))

        BlzSetSpecialEffectScale(sfx, 0.7)

            ShowUnit(unit, false)
            SafePauseUnit(unit, true)
            UnitAddAbility(unit, FourCC("Avul"))

                DelayAction(GetRandomReal(3., 5.), function()
                    DestroyEffect(sfx)
                    local teleport_sfx = AddSpecialEffect("Effect\\Void Teleport Red Caster.mdx", GetUnitX(unit), GetUnitY(unit))
                    BlzSetSpecialEffectScale(teleport_sfx, 0.7)
                    DestroyEffect(teleport_sfx)
                    ShowUnit(unit, true)
                    SafePauseUnit(unit, false)
                    UnitRemoveAbility(unit, FourCC("Avul"))
                    local unit_data = GetUnitData(unit)
                    unit_data.xp = math.floor(unit_data.xp / 6.)
                    unit_data.classification = 0
                    unit_data.droplist = nil
                    IssuePointOrderById(unit, order_attack, x, y)
                    CreateBarOnUnit(unit)
                end)
    end


    local function SpawnMonsters_AttackPoint(rects, monsterpack, monsters,  point_x, point_y, death_trigger)

            for i = 1, #rects do
                SpawnClearMonsterPack(rects[i], monsters, monsterpack, 1, 3, 1, 15., MONSTER_PLAYER)
            end

            ForGroup(monsters, function()
                TriggerRegisterUnitEvent(death_trigger, GetEnumUnit(), EVENT_UNIT_DEATH)
                MonsterSpawner(GetEnumUnit(), point_x, point_y)
            end)


    end

    function Task_SoldiersRescue_Done(player)
        local lootbox = CreateCustomItem("I02H", GetUnitX(PlayerHero[player]), GetUnitY(PlayerHero[player]), false, player-1)
        local unit_data = GetUnitData(gg_unit_n029_0022)

        if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker_done, ANIM_TYPE_DEATH) end

        PlayerTask[player] = nil
        AddToInventory(player, lootbox)
        GiveGoldForPlayer(1000, player)
        GiveExpForPlayer(450, player)
        RemoveJournalEntry(player, "task_soldiersrescue")
        LockInteractiveOptionId(gg_unit_n029_0022, "anar_task_soldiersrescue_done")
    end


    function Task_SoldiersRescue_Aquired(player)
        --local locations = { gg_rct_soldiers_rescue_spawn_1 }

        AddJournalEntry(player, "task_soldiersrescue", "UI\\BTNOrderFootmanIcon.blp", GetLocalString("Спасательная Операция", "Rescue Mission"), 150, true)
        AddJournalEntryText(player, "task_soldiersrescue", GetConversationText(SoldierRescueTaskData[PlayerTask[player]].conversation, gg_unit_n029_0022, player))
        AddJournalEntryObjective(player, "task_soldiersrescue", "task_soldiersrescue_obj", GetLocalString("Солдаты спасены", "Soldiers Rescued"))

        LockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_soldiersrescue", player)
        local unit_data = GetUnitData(gg_unit_n029_0022)
        local target_rect = SoldierRescueTaskData[PlayerTask[player]].rect
        local monster_spawn_rects = SoldierRescueTaskData[PlayerTask[player]].monster_spawner
        local x, y = GetRectCenterX(target_rect), GetRectCenterY(target_rect)

        local soldiers_group = CreateGroup()

        if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker, ANIM_TYPE_DEATH) end


        for i = 1, 3 do
            local id
            local rnd = GetRandomInt(1, 3)
                if rnd == 1 then id = "h005"
                elseif rnd == 2 then id = "h006"
                elseif rnd == 3 then id = "h007" end

                local soldier = CreateUnit(Player(8), FourCC(id), GetRandomReal(GetRectMinX(target_rect), GetRectMaxX(target_rect)), GetRandomReal(GetRectMinY(target_rect), GetRectMaxY(target_rect)), GetRandomReal(230., 320.))
                SetUnitColor(soldier, GetPlayerColor(Player(0)))
                SafePauseUnit(soldier, true)
                UnitAddAbility(soldier, FourCC("Avul"))
                GroupAddUnit(soldiers_group, soldier)
        end

        local cupola_effect = AddSpecialEffect("Effect\\FieldBASE.mdx", x, y)
        BlzSetSpecialEffectScale(cupola_effect, 0.32)
        BlzSetSpecialEffectZ(cupola_effect, GetZ(x, y))
        BlzSetSpecialEffectColor(cupola_effect, 255, 255, 0)

        local blockers = {}

        blockers[#blockers+1] = CreateDestructable(FourCC("YTfb"), x - 64., y + 32., 270., 1., 0)
        blockers[#blockers+1] = CreateDestructable(FourCC("YTfb"), x - 64., y - 32., 270., 1., 0)
        blockers[#blockers+1] = CreateDestructable(FourCC("YTfb"), x + 64., y + 32., 270., 1., 0)
        blockers[#blockers+1] = CreateDestructable(FourCC("YTfb"), x + 64., y - 32., 270., 1., 0)

        blockers[#blockers+1] = CreateDestructable(FourCC("YTfb"), x - 32., y + 64., 270., 1., 0)
        blockers[#blockers+1] = CreateDestructable(FourCC("YTfb"), x - 32., y - 64., 270., 1., 0)
        blockers[#blockers+1] = CreateDestructable(FourCC("YTfb"), x + 32., y + 64., 270., 1., 0)
        blockers[#blockers+1] = CreateDestructable(FourCC("YTfb"), x + 32., y - 64., 270., 1., 0)


        local stage = 0
        local monsters = CreateGroup()
        local monsterpack = GetRandomMonsterTag()

        local death_trigger = CreateTrigger()
        TriggerAddAction(death_trigger, function()
            GroupRemoveUnit(monsters, GetTriggerUnit())
        end)

        local timer = CreateTimer()
        local area_pre
        local defence_periodic_function = function()
            if (GetUnitState(PlayerHero[player], UNIT_STATE_LIFE) < 0.045 or not IsUnitInRangeXY(PlayerHero[player], x, y, 1500.)) and stage ~= -1 then
                AddQuestAreaForPlayer(player, MARK_TYPE_QUESTION, MARK_DAILY, 0.7, 300., x, y-250., area_pre)
                --DestroyTimer(timer)
                stage = -1
                ForGroup(monsters, function()
                    local unit = GetEnumUnit()
                    SafePauseUnit(unit, true)
                    UnitAddAbility(unit, FourCC("Avul"))
                    VanishUnit(unit, 3., { r = 255, g = 255, b = 255 }, function()
                        ShowUnit(unit, false)
                        KillUnit(unit)
                    end)
                end)
            elseif stage == 3 and BlzGroupGetSize(monsters) == 0 then
                stage = 4
                for i = 1, #blockers do RemoveDestructable(blockers[i]) end
                DestroyEffect(cupola_effect)
                UnitShout(FirstOfGroup(soldiers_group), GetLocalString("Спасибо тебе! Благодаря тебе мы спасены", "Thank you! You saved us"), 3.)
                DelayAction(3., function()
                    x = x + 150.
                    y = y + 150.
                    local portal_effect = AddSpecialEffect("Spell\\D2Portal.mdx", x, y)
                    BlzSetSpecialEffectScale(portal_effect, 1.6)
                    AddSoundVolume("Sound\\portalcast.wav", x, y, 128, 1900.)
                    ForGroup(soldiers_group, function()
                        SafePauseUnit(GetEnumUnit(), false)
                        IssuePointOrderById(GetEnumUnit(), order_move, x, y)
                    end)
                    TimerStart(timer, 0.2, true, function()

                        ForGroup(soldiers_group, function()
                            local soldier = GetEnumUnit()

                            if IsUnitInRangeXY(soldier, x, y, 25.) then
                                GroupRemoveUnit(soldiers_group, soldier)
                                ShowUnit(soldier, false)
                                KillUnit(soldier)
                                AddSoundVolume("Sound\\portalenter.wav", x, y, 125, 1500.)
                            else
                                IssuePointOrderById(soldier, order_move, x, y)
                            end

                        end)

                        if BlzGroupGetSize(soldiers_group) == 0 then
                            DestroyTimer(timer)
                            DestroyGroup(soldiers_group)
                            DestroyGroup(monsters)
                            DestroyEffect(portal_effect)
                            if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker_done, ANIM_TYPE_STAND) end
                            UnlockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_soldiersrescue_done", player)
                            SetJournalEntryObjectiveState(player, "task_soldiersrescue", "task_soldiersrescue_obj", JOURNAL_OBJECTIVE_STATE_DONE, true)
                            SoldierRescueTaskData[PlayerTask[player]].occupied = nil
                        end

                    end)
                end)
            elseif stage >= 0 and stage < 3 and BlzGroupGetSize(monsters) == 0 then
                stage = stage + 1
                SpawnMonsters_AttackPoint(monster_spawn_rects, monsterpack, monsters, x, y, death_trigger)
            end
        end

        local area_trigger_function = function()
            stage = 0
            UnitShout(FirstOfGroup(soldiers_group), GetLocalString("Они нападают!", "They are coming!"), 2.)
            TimerStart(timer, 0.2, true, defence_periodic_function)
            SpawnMonsters_AttackPoint(monster_spawn_rects, monsterpack, monsters, x, y, death_trigger)
        end

        area_pre = area_trigger_function
        AddQuestAreaForPlayer(player, MARK_TYPE_QUESTION, MARK_DAILY, 0.7, 300., x, y - 250., area_trigger_function)

    end


    function EnableTask_SoldiersRescue(player)
        local unit_data = GetUnitData(gg_unit_n029_0022)
        if GetLocalPlayer() == Player(player - 1) then BlzPlaySpecialEffect(unit_data.daily_questmarker, ANIM_TYPE_STAND) end
        UnlockInteractiveOptionIdPlayer(gg_unit_n029_0022, "anar_task_soldiersrescue", player)
    end

    function InitTasksData()
        PlayerTask = {}
        SoldierRescueTaskData = {}
        SoldierRescueTaskData[1] = {
            rect = gg_rct_soldiers_rescue_spawn_1,
            monster_spawner = { gg_rct_soldier_rescue_1_monster_spawn_1, gg_rct_soldier_rescue_1_monster_spawn_2, gg_rct_soldier_rescue_1_monster_spawn_3 },
            occupied = false,
            conversation = "quartermaster_task_soldiersrescue_1_give"
        }
    end


    function EnableAnarTasks()

        PlayerTask = {}
        SoldierRescueTaskData = {
            [1] = {
                rect = gg_rct_soldiers_rescue_spawn_1,
                monster_spawner = { gg_rct_soldier_rescue_1_monster_spawn_1, gg_rct_soldier_rescue_1_monster_spawn_2, gg_rct_soldier_rescue_1_monster_spawn_3 },
                occupied = false,
                conversation = "quartermaster_task_soldiersrescue_1_give"
            },
            [2] = {
                rect = gg_rct_soldiers_rescue_spawn_2,
                monster_spawner = { gg_rct_soldier_rescue_1_monster_spawn_2, gg_rct_soldier_rescue_2_monster_spawn_2, gg_rct_soldier_rescue_2_monster_spawn_3 },
                occupied = false,
                conversation = "quartermaster_task_soldiersrescue_2_give"
            },
            [3] = {
                rect = gg_rct_soldiers_rescue_spawn_3,
                monster_spawner = { gg_rct_soldier_rescue_3_monster_spawn_1, gg_rct_soldier_rescue_3_monster_spawn_2, gg_rct_soldier_rescue_3_monster_spawn_3 },
                occupied = false,
                conversation = "quartermaster_task_soldiersrescue_3_give"
            },
            [4] = {
                rect = gg_rct_soldiers_rescue_spawn_4,
                monster_spawner = { gg_rct_soldier_rescue_4_monster_spawn_1, gg_rct_soldier_rescue_4_monster_spawn_2, gg_rct_soldier_rescue_4_monster_spawn_3 },
                occupied = false,
                conversation = "quartermaster_task_soldiersrescue_4_give"
            },
            [5] = {
                rect = gg_rct_soldiers_rescue_spawn_5,
                monster_spawner = { gg_rct_soldier_rescue_5_monster_spawn_1, gg_rct_soldier_rescue_5_monster_spawn_2, gg_rct_soldier_rescue_5_monster_spawn_3 },
                occupied = false,
                conversation = "quartermaster_task_soldiersrescue_5_give"
            },
            [6] = {
                rect = gg_rct_soldiers_rescue_spawn_6,
                monster_spawner = { gg_rct_soldier_rescue_6_monster_spawn_1, gg_rct_soldier_rescue_6_monster_spawn_2, gg_rct_soldier_rescue_6_monster_spawn_3 },
                occupied = false,
                conversation = "quartermaster_task_soldiersrescue_6_give"
            },
            [7] = {
                rect = gg_rct_soldiers_rescue_spawn_7,
                monster_spawner = { gg_rct_soldier_rescue_7_monster_spawn_1, gg_rct_soldier_rescue_7_monster_spawn_2, gg_rct_soldier_rescue_7_monster_spawn_3 },
                occupied = false,
                conversation = "quartermaster_task_soldiersrescue_7_give"
            },
        }


        TimerStart(CreateTimer(), 10., true, function()
            for player = 1, 6 do
                if PlayerHero[player] and not PlayerTask[player] then
                    if Chance(3.) then
                        if GetRandomInt(1, 2) == 1 then
                            local random = GetRandomInt(1, 4)
                            local tasks = { EnableTask_Arachno, EnableTask_BanditLord, EnableTask_SpiderQueen, EnableTask_RestlessUndead }

                                if GetUnitState(BossPack[random].boss, UNIT_STATE_LIFE) > 0.045 then
                                    tasks[random](player)
                                    PlayerTask[player] = true
                                end

                        else
                            local random_list = GetRandomIntTable(1, #SoldierRescueTaskData, #SoldierRescueTaskData)

                                for i = 1, #random_list do
                                    if not SoldierRescueTaskData[random_list[i]].occupied then
                                        EnableTask_SoldiersRescue(player)
                                        PlayerTask[player] = random_list[i]
                                        SoldierRescueTaskData[random_list[i]].occupied = true
                                        break
                                    end
                                end
                        end

                    end
                end
            end
        end)

    end
    
end 