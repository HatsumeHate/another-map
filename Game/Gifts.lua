---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by hatsu.
--- DateTime: 05.07.2023 21:51
---
do

    GLOBAL_EXP_RATE = 1.
    GLOBAL_DROP_RATE = 1.
    GLOBAL_GOLD_RATE = 1.
    GLOBAL_WAVE_SKIP_BONUS = 0


    --[[
        собирание душ врагов, собрав 50 дает маг предмет

    ]]

    function DemonicHornActivationEffect()
        ForGroup(ScaleMonstersGroup, function()
            ModifyStat(GetEnumUnit(), HP_VALUE, 1.25, MULTIPLY_BONUS, true)
        end)
        GLOBAL_WAVE_SKIP_BONUS = GLOBAL_WAVE_SKIP_BONUS + 2
        GLOBAL_DROP_RATE = GLOBAL_DROP_RATE + 0.15
    end


    function DemonicHornDeactivationEffect()
        ForGroup(ScaleMonstersGroup, function()
            ModifyStat(GetEnumUnit(), HP_VALUE, 1.25, MULTIPLY_BONUS, false)
        end)
        GLOBAL_WAVE_SKIP_BONUS = GLOBAL_WAVE_SKIP_BONUS - 2
        GLOBAL_DROP_RATE = GLOBAL_DROP_RATE - 0.15
    end


    local BoneChimesBosses
    local BoneChimesTimer

    function BoneChimesActivationEffect()

        BoneChimesBosses = {
            CreateUnit(SECOND_MONSTER_PLAYER, FourCC("u013"), GetRectCenterX(gg_rct_chimes_boss_1), GetRectCenterY(gg_rct_chimes_boss_1), 270.),
            CreateUnit(SECOND_MONSTER_PLAYER, FourCC("u013"), GetRectCenterX(gg_rct_chimes_boss_2), GetRectCenterY(gg_rct_chimes_boss_2), 270.),
            CreateUnit(SECOND_MONSTER_PLAYER, FourCC("u013"), GetRectCenterX(gg_rct_chimes_boss_3), GetRectCenterY(gg_rct_chimes_boss_3), 270.)
        }

        for i = 1, 3 do CreateLeashForUnit(BoneChimesBosses[i], 1450.) end

        BoneChimesTimer = CreateTimer()

        TimerStart(BoneChimesTimer, 15., true, function()
            if BoneChimesBosses[1] and GetUnitState(BoneChimesBosses[1], UNIT_STATE_LIFE) > 0.045 then PingMinimap(GetRectCenterX(gg_rct_chimes_boss_1), GetRectCenterY(gg_rct_chimes_boss_1), 3.) end
            if BoneChimesBosses[2] and GetUnitState(BoneChimesBosses[2], UNIT_STATE_LIFE) > 0.045 then PingMinimap(GetRectCenterX(gg_rct_chimes_boss_2), GetRectCenterY(gg_rct_chimes_boss_2), 3.) end
            if BoneChimesBosses[3] and GetUnitState(BoneChimesBosses[3], UNIT_STATE_LIFE) > 0.045 then PingMinimap(GetRectCenterX(gg_rct_chimes_boss_3), GetRectCenterY(gg_rct_chimes_boss_3), 3.) end
        end)

    end


    function BoneChimesDeactivationEffect()
        for i = 1, 3 do
            if BoneChimesBosses[i] and GetUnitState(BoneChimesBosses[i], UNIT_STATE_LIFE) > 0.045 then
                UnitAddAbility(BoneChimesBosses[i], FourCC("Avul"))
                UnitAddAbility(BoneChimesBosses[i], FourCC("Abun"))
                VanishUnit(BoneChimesBosses[i], 3., { r = 255,g = 255,b = 255 }, function()
                    ShowUnit(BoneChimesBosses[i], false)
                    KillUnit(BoneChimesBosses[i])
                end)
                DestroyTimer(BoneChimesTimer)
            end
        end

    end


    function ScreamingMaskActivationEffect()

        GLOBAL_EXP_RATE = GLOBAL_EXP_RATE + 0.25
        GLOBAL_WAVE_SKIP_BONUS = GLOBAL_WAVE_SKIP_BONUS + 1

        ForGroup(ScaleMonstersGroup, function()
            ModifyStat(GetEnumUnit(), CRIT_CHANCE, 25, STRAIGHT_BONUS, true)
        end)

    end


    function ScreamingMaskDeactivationEffect()

        GLOBAL_EXP_RATE = GLOBAL_EXP_RATE - 0.25
        GLOBAL_WAVE_SKIP_BONUS = GLOBAL_WAVE_SKIP_BONUS - 1

        ForGroup(ScaleMonstersGroup, function()
            ModifyStat(GetEnumUnit(), CRIT_CHANCE, 25, STRAIGHT_BONUS, false)
        end)

    end



    function HearthGhorActivationEffect()
        GLOBAL_GOLD_RATE = GLOBAL_GOLD_RATE + 0.15
        GLOBAL_WAVE_SKIP_BONUS = GLOBAL_WAVE_SKIP_BONUS + 1
    end

    function HearthGhorDeactivationEffect()
        GLOBAL_GOLD_RATE = GLOBAL_GOLD_RATE - 0.15
        GLOBAL_WAVE_SKIP_BONUS = GLOBAL_WAVE_SKIP_BONUS - 1
    end


    function MoonStoneActivationEffect()
        GLOBAL_WAVE_SKIP_BONUS = GLOBAL_WAVE_SKIP_BONUS + 1

            for i = 1, 6 do
                if PlayerHero[i] then
                    ModifyStat(PlayerHero[i], CRIT_CHANCE, 7, STRAIGHT_BONUS, true)
                end
            end

    end

    function MoonStoneDeactivationEffect()
        GLOBAL_WAVE_SKIP_BONUS = GLOBAL_WAVE_SKIP_BONUS - 1

            for i = 1, 6 do
                if PlayerHero[i] then
                    ModifyStat(PlayerHero[i], CRIT_CHANCE, 7, STRAIGHT_BONUS, false)
                end
            end

    end

    function SwordofaHeroActivationEffect()
        GLOBAL_WAVE_SKIP_BONUS = GLOBAL_WAVE_SKIP_BONUS + 1

            for i = 1, 6 do
                if PlayerHero[i] then
                    ModifyStat(PlayerHero[i], BONUS_DEMON_DAMAGE, 25, STRAIGHT_BONUS, true)
                    ModifyStat(PlayerHero[i], BONUS_UNDEAD_DAMAGE, 25, STRAIGHT_BONUS, true)
                end
            end

    end

    function SwordofaHeroDeactivationEffect()
        GLOBAL_WAVE_SKIP_BONUS = GLOBAL_WAVE_SKIP_BONUS - 1

            for i = 1, 6 do
                if PlayerHero[i] then
                    ModifyStat(PlayerHero[i], BONUS_DEMON_DAMAGE, 25, STRAIGHT_BONUS, false)
                    ModifyStat(PlayerHero[i], BONUS_UNDEAD_DAMAGE, 25, STRAIGHT_BONUS, false)
                end
            end

    end

    function ForestWardActivationEffect()
        GLOBAL_WAVE_SKIP_BONUS = GLOBAL_WAVE_SKIP_BONUS + 1

            for i = 1, 6 do
                if PlayerHero[i] then
                    ModifyStat(PlayerHero[i], ALL_RESIST, 7, STRAIGHT_BONUS, true)
                end
            end

    end

    function ForestWardDeactivationEffect()
        GLOBAL_WAVE_SKIP_BONUS = GLOBAL_WAVE_SKIP_BONUS - 1

            for i = 1, 6 do
                if PlayerHero[i] then
                    ModifyStat(PlayerHero[i], ALL_RESIST, 7, STRAIGHT_BONUS, false)
                end
            end

    end


end